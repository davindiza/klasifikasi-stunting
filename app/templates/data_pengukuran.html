{% extends "layout.html" %} {% block title %}Data Anak - Puskesmas{% endblock %}
{% block content %}
<!-- Page Heading -->
<h1 class="h3 mb-4 text-gray-800">Data Pengukuran Balita</h1>

<!-- Informasi Umum Anak -->
<div class="card shadow mb-4">
  <div class="card-body">
    <div class="row">
      <div class="col-md-6 mb-2"><strong>NIK:</strong> {{ anak.nik }}</div>
      <div class="col-md-6 mb-2">
        <strong>Tgl Lahir:</strong> {{ anak.tgl_lahir.strftime('%d-%m-%Y') }}
      </div>
      <div class="col-md-6 mb-2"><strong>Nama:</strong> {{ anak.nama }}</div>
      <div class="col-md-6 mb-2">
        <strong>Jenis Kelamin:</strong> {{ 'Laki-laki' if anak.jk == 'L' else
        'Perempuan' }}
      </div>
      <div class="col-md-6 mb-2">
        <strong>Umur:</strong>
        {% if detail_terakhir and detail_terakhir.umur is not none %} {{
        detail_terakhir.umur }} bulan {% else %} - {% endif %}
      </div>
    </div>
  </div>
</div>

<!-- Tombol Aksi -->
<div class="mb-3 d-flex flex-wrap gap-2">
  <a
    href="{{ url_for('input_pengukuran', anak_id=anak_id) }}"
    class="btn btn-success btn-sm"
    ><i class="fas fa-plus"></i> Tambah Pengukuran</a
  >
</div>

<!-- Tabel Data Pengukuran -->
<div class="card shadow mb-4">
  <div class="card-body table-responsive">
    <table class="table table-bordered table-hover">
      <thead class="thead-light text-center">
        <tr>
          <th>Tgl Ukur</th>
          <th>Berat (kg)</th>
          <th>Tinggi (cm)</th>
          <th>Cara Ukur</th>
          <th>ZS BB/U</th>
          <th>ZS TB/U</th>
          <th>ZS BB/TB</th>
          <th>LILA</th>
          <th>Lingkar Kepala</th>
          <th>Edema</th>
          <th>Ikut Kelas Ibu?</th>
          <th>Tindakan</th>
        </tr>
      </thead>
      <tbody>
        {% for pengukuran, detail in pengukuran_list %}
        <tr>
          <td>{{ pengukuran.created_at.strftime('%d-%m-%Y') }}</td>
          <td>{{ pengukuran.berat }}</td>
          <td>{{ pengukuran.tinggi }}</td>
          <td>{{ pengukuran.cara_ukur }}</td>
          <td>{{ '%.2f'|format(detail.zs_bb_u) if detail else '-' }}</td>
          <td>{{ '%.2f'|format(detail.zs_tb_u) if detail else '-' }}</td>
          <td>{{ '%.2f'|format(detail.zs_bb_tb) if detail else '-' }}</td>
          <td>{{ pengukuran.lila }}</td>
          <td>{{ pengukuran.lingkar_kepala }}</td>
          <td>{{ pengukuran.edema }}</td>
          <td>{{ pengukuran.ikut_kelas_ibu }}</td>
          <td class="text-center">
            <a
              href="{{ url_for('edit_pengukuran', anak_id=pengukuran.id_anak, pengukuran_id=pengukuran.id) }}"
              class="btn btn-warning btn-circle"
            >
              <i class="fas fa-pen"></i>
            </a>
            <form
              action="{{ url_for('delete_pengukuran', anak_id=anak.id, pengukuran_id=pengukuran.id) }}"
              method="POST"
              onsubmit="return confirm('Yakin ingin menghapus data ini?');"
            >
              <button type="submit" class="btn btn-circle btn-danger">
                <i class="fas fa-trash"></i>
              </button>
            </form>
          </td>
        </tr>
        {% endfor %}

        <!-- Tambahkan baris lainnya jika perlu -->
      </tbody>
    </table>
  </div>
</div>

{% endblock %}
